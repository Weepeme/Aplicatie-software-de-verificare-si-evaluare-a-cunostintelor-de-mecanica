<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8" />
    <title>Punctaj Global Studenti</title>
    <style>
    body {
        font-family: Arial, sans-serif;
        background: white;
        color: black;
    }
    table {
        width: 100%;
        border-collapse: collapse;
        background-color: white; 
        color: black; 
    }
    th, td {
        border: 1px solid black; 
        padding: 8px;
        text-align: center;
        color: black; 
    }
    th {
        font-weight: bold;
        background-color: white; 
        color: black; 
    }
</style>

</head>
<body>
    <style>
  h1 {
    text-align: center;
    font-weight: bold;
    margin-bottom: 20px;
  }
</style>
    <h1>Punctaj Global Studenti</h1>
    <table>
        <thead>
            <tr>
                <th>Nume Prenume Student</th>
                <th>Grad de dificultate</th>
                <th>Data si ora testului</th>
                <th>Punctaj</th>
                <th>Media Punctajelor</th>
                <th>Media Echivalata</th>
            </tr>
        </thead>
        <tbody>
        {% for student_name, data in students.items() %}
            {% for test in data.tests %}
            <tr>
                {% if loop.first %}
                <td rowspan="{{ data.tests|length }}">{{ student_name }}</td>
                {% endif %}
                <td class="grade">{{ test.difficulty }}</td>
                <td>{{ test.completed_at.strftime('%d-%m-%Y %H:%M') if test.completed_at else 'N/A' }}</td>
                <td>{{ test.score }}/12</td>
                {% if loop.first %}
                <td rowspan="{{ data.tests|length }}">{{ '%.2f'|format(data.average_score) }}/12</td>
                <td rowspan="{{ data.tests|length }}">{{ '%.2f'|format(data.average_grade) }}/10</td>
                {% endif %}
            </tr>
            {% endfor %}
        {% endfor %}
        </tbody>
    </table>
</body>
</html>
